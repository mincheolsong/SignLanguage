## ì œì‘ë™ê¸°

Â **ì²­ê°ì¥ì• ì¸ì„ ìœ„í•œ ì¸ê³µì§€ëŠ¥**

  
Â ì¸ê³µì§€ëŠ¥ ê¸°ìˆ ì´ ê¸‰ì†ë„ë¡œ ë°œì „í•˜ê³  ìˆëŠ” í˜„ì¬, ì´ë¥¼ í™œìš©í•˜ì—¬ ì¼ìƒìƒí™œì— ë¶ˆí¸ì„ ëŠë¼ëŠ” ì¥ì• ì¸ ë¶„ë“¤ì„ ìœ„í•œ ì œí’ˆì„ ë§Œë“¤ì–´ ë³´ê³  ì‹¶ì—ˆë‹¤. ê·¸ ì¤‘ ì²­ê°ì¥ì• ì¸ì„ ìœ„í•œ ìˆ˜í™”ì¸ì‹ í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ë©´ ì¢‹ê² ë‹¤ê³  ìƒê°í•˜ê²Œ ë˜ì—ˆë‹¤.

  
Â MediaPipe ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì†ì˜ jointë¥¼ ê²€ì¶œí•œë‹¤.

ê·¸ ì¶œë ¥ ê²°ê³¼ë¥¼ ë‹¨ì¼ ë™ì‘ìœ¼ë¡œ ë¶„ë¥˜ í•  ìˆ˜ ìˆëŠ” KNN(K-NearestÂ  Neighbor)ê³¼ ì—°ì† ë™ì‘ì„ ë¶„ë¥˜ í•  ìˆ˜ ìˆëŠ” RNN(Recurrent Neural Network)ì˜ ì…ë ¥ìœ¼ë¡œ í•™ìŠµí•˜ì—¬ ì§€í™”ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¸ì‹í•˜ê³  ì¶œë ¥í•œë‹¤.

## ì´ë¡ ì  ë°°ê²½

### MediaPipe

Â MediaPipeë€ êµ¬ê¸€ì—ì„œ ì œê³µí•˜ëŠ” AI í”„ë ˆì„ì›Œí¬ë¡œì¨, ë¹„ë””ì˜¤ í˜•ì‹ ë°ì´í„°ë¥¼ ì´ìš©í•œ ë‹¤ì–‘í•œ ë¹„ì „ AIê¸°ëŠ¥ì„ íŒŒì´í”„ë¼ì¸ í˜•íƒœë¡œ ì†ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì œê³µëœë‹¤.

AI ëª¨ë¸ ê°œë°œ ë° ìˆ˜ë§ì€ ë°ì´í„°ì…‹ì„ ì´ìš©í•œ í•™ìŠµë„ ë§ˆì¹œ ì‚¬íƒœë¡œ ì œê³µë˜ë¯€ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¶ˆëŸ¬ ì‚¬ìš©í•˜ë“¯ì´ ê°„í¸í•˜ê²Œ í˜¸ì¶œí•˜ì—¬ ì‚¬ìš©í•˜ê¸°ë§Œ í•˜ë©´ ë˜ëŠ” í˜•íƒœë¡œ, ë¹„ì „ AI ê¸°ëŠ¥ì„ ê°œë°œ í•  ìˆ˜ ìˆë‹¤.

![image](https://github.com/mincheolsong/mincheolsong/assets/80660585/1ad030e5-4606-4843-87e6-e9238dddbba8)  


![image](https://github.com/mincheolsong/mincheolsong/assets/80660585/d4481667-d447-4eb9-9d2d-a3c38c2a24ce)  


  
Â ë‹¤ìŒê³¼ ê°™ì´ ì†ì„ ì¸ì‹í•˜ì—¬ ì¤€ë‹¤.

ì´ë•Œ ë¹¨ê°„ì ìœ¼ë¡œ í‘œì‹œëœ ë§ˆë””(joint)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë²¡í„°ë¥¼ ë§Œë“¤ê³ ,

ê·¸ ë²¡í„°ë“¤ ì‚¬ì´ì˜ ê°ë„ë¥¼ ì´ìš©í•´ì„œ ì† ëª¨ì–‘ì„ í•™ìŠµì‹œí‚¬ ìˆ˜ ìˆë‹¤.

### KNN(K-Nearest Neighbor)

knnì€ ìµœê·¼ì ‘ ì´ì›ƒ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ _ì§€ë„í•™ìŠµ_ ì•Œê³ ë¦¬ì¦˜ ì¤‘ í•˜ë‚˜ì´ë‹¤.

> -   **ì§€ë„í•™ìŠµ** : ì—¬ëŸ¬ ë¬¸ì œì™€ ë‹µì„ ê°™ì´ í•™ìŠµí•¨ìœ¼ë¡œì¨ ë¯¸ì§€ì˜ ë¬¸ì œì•  ëŒ€í•œ ì˜¬ë°”ë¥¸ ë‹µì„ ì˜ˆì¸¡í•˜ê³ ì í•˜ëŠ” ë°©ë²•ì´ë‹¤. ë”°ë¼ì„œ ì§€ë„í•™ìŠµì—ëŠ” ë¬¸ì œì™€ í•¨ê»˜ ê·¸ ì •ë‹µê¹Œì§€ ì•Œê³ ìˆëŠ” ë°ì´í„°ê°€ ì œê³µë˜ì–´ì•¼ í•œë‹¤.  
>       
>     
> -   **ë¹„ì§€ë„í•™ìŠµ** : ì§€ë„í•™ìŠµê³¼ëŠ” ë‹¬ë¦¬ **ì •ë‹µ ë¼ë²¨ì´ ì—†ëŠ” ë°ì´í„°**ë¥¼ ë¹„ìŠ·í•œ íŠ¹ì§•ë¼ë¦¬ êµ°ì§‘í™” í•˜ì—¬ ìƒˆë¡œìš´ ë°ì´í„°ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ë°©ë²•ì´ë‹¤.

ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ì…ë ¥ ë°›ì•˜ì„ë•Œ, í•´ë‹¹ ë°ì´í„°ì™€ ê°€ì¥ ê°€ê¹Œì´ì— ìˆëŠ” kê°œì˜ ë°ì´í„°ë¥¼ í™•ì¸í•´, ìƒˆë¡œìš´ ë°ì´í„°ì˜ íŠ¹ì„±ì„ íŒŒì•…í•˜ëŠ” ë°©ë²•ì´ë‹¤.

![image](https://github.com/mincheolsong/mincheolsong/assets/80660585/bdcbf06a-78f1-4444-839c-0104200ae968)  


Â  **ìœ„ ê·¸ë¦¼ì—ì„œ '?'ì˜ ì£¼ë³€ì— ê°€ì¥ ê°€ê¹ê³  ë§ì´ ìˆëŠ”ê²ƒì´ ë¬´ì—‡ì¸ê°€** ë¥¼ í™•ì¸í•˜ì—¬ '?'ê°€ ì‚¼ê°í˜•ì¸ì§€ ì›ì¸ì§€ íŒë³„í•˜ëŠ” ê²ƒì´ë‹¤.

-   Kê°€ 1ì¼ê²½ìš° '?'ì£¼ë³€ì—ëŠ” ê°€ì¥ ê°€ê¹ê³  ë§ì´ ìˆëŠ”ê²ƒì€ ì› í•˜ë‚˜ì´ë¯€ë¡œ '?'ëŠ” ì›ìœ¼ë¡œ íŒë³„í•œë‹¤.
-   Kê°€ 4ì¼ ê²½ìš° '?'ì£¼ë³€ì— ê°€ì¥ê°€ê¹ê³  ë§ì´ ìˆëŠ”ê²ƒì€ ì‚¼ê°í˜•ì´ë¯€ë¡œ '?'ëŠ” ì‚¼ê°í˜•ìœ¼ë¡œ íŒë³„í•œë‹¤.

**ê·¸ëŸ¬ë©´ KëŠ” ëª‡ìœ¼ë¡œ ì„¤ì •í•˜ëŠ”ê²Œ ê°€ì¥ ì¢‹ì„ê¹Œ?**

-   kê°€ ë‚®ë‹¤ â†’ ì ì€ ì´ì›ƒ ìˆ˜ë¡œ íŒë‹¨í•œë‹¤ â†’ ë¶ˆì•ˆì •í•œ ê²°ê³¼
-   kê°€ ë†’ë‹¤ â†’ ë§ì€ ì´ì›ƒ ìˆ˜ë¡œ íŒë‹¨í•œë‹¤ â†’ ì§€ë‚˜ì¹œ ì¼ë°˜í™”
-   **ê°€ì¥ ì¢‹ì€ ì„±ëŠ¥ì„ ë‚´ëŠ” kë¥¼ ì„ íƒ**
    -   kì˜ ê°’ì„ 1ë¶€í„° ì¦ê°€ì‹œì¼œê°€ë©° ê° ì ë“¤ì— ëŒ€í•´ knnìœ¼ë¡œ ë¶„ë¥˜í•´ë³´ê³  ì˜¤ë¥˜ ê³„ì‚°
    -   ê°€ì¥ ì˜¤ë¥˜ê°€ ì ì€ kê°’ì„ ì„ íƒ

### RNN

RNNì€ ìŒì„±, ë¬¸ìì™€ ê°™ì´ ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰í•˜ëŠ” ë°ì´í„° ì²˜ë¦¬ì— ì í•©í•œ ì•Œê³ ë¦¬ì¦˜ ì´ë‹¤.

![image](https://github.com/mincheolsong/mincheolsong/assets/80660585/6f625658-0e9e-460a-ab71-b796f8067d2e)  


Â ê·¸ë¦¼ê³¼ ê°™ì´ hidden layerì˜ ê²°ê³¼ê°€ ë‹¤ì‹œ hidden layerì˜ ì…ë ¥ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ìˆœí™˜ë˜ëŠ” êµ¬ì¡°ë¥¼ ê°€ì¡Œê¸° ë•Œë¬¸ì— ì¬ê·€ ì¸ê³µ ì‹ ê²½ë§ì´ë¼ê³  ë¶ˆë¦°ë‹¤.

Â hidden layerì˜ ê²°ê³¼ê°€ ë‹¤ì‹œ hidden layerì˜ ì…ë ¥ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” íŠ¹ì„± ë•Œë¬¸ì— RNNì€ í˜„ì¬ ë“¤ì–´ì˜¤ëŠ” ì…ë ¥ ë°ì´í„°ì™€ ì „ ë‹¨ê³„ì—ì„œ ë‚˜ì˜¨ ê²°ê³¼ë¥¼ ë™ì‹œì— ê³ ë ¤í•˜ê²Œ ë¨ìœ¼ë¡œì¨ ê¸°ì–µ ëŠ¥ë ¥ì´ ìˆë‹¤ê³  í•  ìˆ˜ ìˆê²Œ ë˜ê³ , sequence ë˜ëŠ” ì‹œê³„ì—´ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ëŠ”ë° êµ‰ì¥ì´ íš¨ê³¼ì ì¸ ë„¤íŠ¸ì›Œí¬ì´ë‹¤.

## êµ¬í˜„ ê³¼ì •

### 1\. media pipeê°€ ì œê³µí•´ ì£¼ëŠ” ì†ì˜ jointë¥¼ í™œìš©í•˜ì—¬ ë²¡í„°ì‚¬ì´ì˜ ê°ë„ë¥¼ êµ¬í•œë‹¤.

![image](https://github.com/mincheolsong/mincheolsong/assets/80660585/39b43368-692e-4f62-9289-73f19ed3d7b4)


1ï¸âƒ£ ì ê³¼ ì ì‚¬ì´ì˜ ëº„ì…ˆ ì—°ì‚°ì„ í†µí•´ 0ë²ˆì—ì„œ 1ë²ˆìœ¼ë¡œ ê°€ëŠ” ë²¡í„°, 1ë²ˆì—ì„œ 2ë²ˆìœ¼ë¡œ ê°€ëŠ” ë²¡í„° ë“±ë“± ë§ì€ ë²¡í„°ë¥¼ ë§Œë“¤ì–´ë‚¸ë‹¤.

```
if result.multi_hand_landmarks:
        for hand_landmarks in result.multi_hand_landmarks: # ì—¬ëŸ¬ê°œì˜ ì†ì„ ì¸ì‹ í•  ìˆ˜ ìˆìœ¼ë‹ˆê¹Œ, forë¬¸ ë°˜ë³µ
            joint = np.zeros((21,4)) # ì† ê´€ì ˆ (joint) ë„˜íŒŒì´ ë°°ì—´ë¡œ ìƒì„±
            for j, lm in enumerate(hand_landmarks.landmark): # media pipeì˜ landmarkë¥¼ ë°˜ë³µí•˜ë©° jointì— ëŒ€ì…
                joint[j] = [lm.x,lm.y,lm.z,lm.visibility]

            v1 = joint[[0,1,2,3,0,5,6,7,0, 9,10,11, 0,13,14,15, 0,17,18,19],:3] # ë²¡í„°ë¥¼ êµ¬í•˜ê¸° ìœ„í•´ ìƒì„±í•˜ëŠ” v1,v2 (v2ì—ì„œ v2ì„ ë¹¼ë©´ vë°±í„°ê°€ ëœë‹¤)
            v2 = joint[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],:3]

            v = v2-v1
            v = v / np.linalg.norm(v,axis=1)[:,np.newaxis] # ì •ê·œí™”
```

2ï¸âƒ£ ë§Œë“¤ì–´ì§„ ë²¡í„°ë“¤ ì‚¬ì´ì˜ ê°ë„ë¥¼ êµ¬í•œë‹¤

```
compareV1 = v[[0,1,2,4,5,6,8,9,10,12,13,14,16,17,18],:] #ê° ë²¡í„°ì˜ ê°ë„ë¥¼ ë¹„êµí•˜ê¸° ìœ„í•´ ìƒì„±í•˜ëŠ” compareë²¡í„°
compareV2 = v[[1,2,3,5,6,7,9,10,11,13,14,15,17,18,19],:]

angle = np.arccos(np.einsum('nt,nt->n',compareV1,compareV2)) # compareë²¡í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°ë„ë¥¼ êµ¬í•¨
angle = np.degrees(angle)
```

3ï¸âƒ£ ì† ëª¨ì–‘ì— ë”°ë¥¸ ë°ì´í„°ì…‹ íŒŒì¼ì„ writeí•œë‹¤

```
 if keyboard.is_pressed('a'): # gestureë¥¼ í•™ìŠµí•˜ê¸° ìœ„í•œ ì¡°ê±´ë¬¸(aí‚¤ë¥¼ ëˆ„ë¥´ê³  ìˆìœ¼ë©´ ê°ë„ì™€ ë¼ë²¨ì´ test.txtì— writeë¨)
        for num in angle:
            num = round(num,6)
            f.write(str(num))
            f.write(',')

        f.write("25.000000") # í•™ìŠµí•˜ê³ ì í•˜ëŠ” ì† ë™ì‘ì˜ ë¼ë²¨

        f.write('\n')
        print('next')
```

â˜

Â ë°ì´í„° ì…‹ì„ êµ¬í•˜ëŠ” ì½”ë“œì´ë‹¤. í‚¤ë³´ë“œ 'a'í‚¤ë¥¼ ëˆ„ë¥´ê³  ìˆìœ¼ë©´ test.txtíŒŒì¼ì— í˜„ì¬ ê°ë„ì™€ ì† ë™ì‘ì˜ ë¼ë²¨ì´ writeëœë‹¤.  
Â 

ì´ë ‡ê²Œ ì† ë™ì‘ í•˜ë‚˜í•˜ë‚˜ì— ëŒ€í•´ì„œ êµ¬í•œ ì •ë³´ë¥¼ dataSet.txtíŒŒì¼ì— ë¶™ì—¬ë„£ì–´ ë°ì´í„°ì…‹ì„ ì™„ì„±í•˜ì˜€ë‹¤.  

![image](https://github.com/mincheolsong/mincheolsong/assets/80660585/c26a3924-573f-4007-8d49-5d5efd85cf32)  


(ìˆ˜ì§‘í•œ ë°ì´í„°ì…‹)

### 2-1. êµ¬í•´ì§„ ê°ë„ì™€ KNN ì„ ì‚¬ìš©í•˜ì—¬ ì •ì ì¸ ì†ë™ì‘ì„ í•™ìŠµì‹œí‚¨ë‹¤.

```
data = np.array([angle],dtype=np.float32)

ret, results, neighbours, dist = knn.findNearest(data,3) #knnì•Œê³ ë¦¬ì¦˜ ì ìš©
```

â˜

Â  êµ¬í•œ angleì„ numpy í˜•íƒœ ë°ì´í„°ë¡œ ë§Œë“¤ê³ , ê·¸ ë°ì´í„°ì— knnì„ ì‚¬ìš©í•˜ì—¬ í•™ìŠµì‹œí‚¤ëŠ” ì½”ë“œì´ë‹¤.

ìˆ˜í–‰ê²°ê³¼

![image](https://github.com/mincheolsong/mincheolsong/assets/80660585/4de15d6b-7d43-4706-96fb-a3158253d3f8)  
  

![image](https://github.com/mincheolsong/mincheolsong/assets/80660585/f3d2acfd-79c4-4d5d-a70e-4e5c28beb78e)  


  
ê·¸ë¦¼ê³¼ ê°™ì´ ì†ë™ì‘ì— ë”°ë¥¸ ììŒì´ ì˜ ì¶œë ¥ë˜ì—ˆë‹¤.

### 2-2. 'done'ë™ì‘ì„ ì·¨í•˜ë©´ ì…ë ¥í•œ ì´ˆì„±ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë‹¨ì–´ëª©ë¡ì„ ì¶œë ¥í•˜ì—¬ ì¤€ë‹¤

ë™ì‘ë§ˆë‹¤ indexë²ˆí˜¸ë¥¼ ë§¤ê²¨ë†“ì•˜ë‹¤.

ğŸ‘‡

```
gesture = {
    0:'ã„±',1:'ã„´',2:'ã„·',3:'ã„¹',4:'ã…',5:'ã…‚',6:'ã……',7:'ã…‡',
    8:'ã…ˆ',9:'ã…Š',10:'ã…‹',11:'ã…Œ',12:'ã…',13:'ã…', 25:'done',26:'spacing',27:'clear'
}
```

```
complete = 0 # ê¸€ì”¨ ì…ë ¥ì„ ì™„ë£Œ í–ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë³€ìˆ˜(done ë™ì‘ì„ í•˜ë©´ 1ë¡œ ë°”ê¿ˆ)
                                    .
                                    .
                                    .

    if index == 25: # doneë™ì‘(25ìœ„ì—ì„œ ì½ì€ dic_fileì—ì„œ sentceê²€ìƒ‰í•˜ê³ , ê·¸ ìœ„ì¹˜ì˜ ë‹¨ì–´ë¥¼ ì¶œë ¥
        for i in range(0, dic_file.[0]):
            if (sentence == dic['ì´ˆì„±'][i]):
                selected_words.append(dic_file['ë‹¨ì–´'][i])

        complete=1 #complete ë¥¼ ìœ„í•´ 1ë¡œ ë³€ê²½í•œë‹¤
        i=0
        word=''
    elif complete==0 and index!=27index!=26:
        sentence += gesture[index]
    startTime = time.time()

    if complete==0:
        word = gesture[index]
    draw.text((int(hand_landmarks.landmar   x*image.shape[1]),int(hand_landm   landmark[0].y*image.shape[0])), word,  font=font, fill=(255,255,255))


    draw.text((20,400),sentence,font=font,fill=(255,255,255))

    if complete==1:
        print(sentence)
        print(selected_words)

                                    .
                                    .
                                    .
```

25ë²ˆ ë™ì‘, ì¦‰ doneì„ í•˜ë©´ dicì—ì„œ ì…ë ¥í•œ ì´ˆì„±ì„ ê²€ìƒ‰í•˜ê³ , `selected_words`ì— `append`í•œë‹¤.

ê·¸ ë‹¤ìŒ ì¼ì¢…ì˜ `flagë³€ìˆ˜`ì—­í• ì„ í•˜ëŠ” completeë¥¼ 1ë¡œ ë³€ê²½ì‹œí‚¨ë‹¤.  

_(ì´ë ‡ê²Œ í•˜ëŠ” ì´ìœ ëŠ” doneë™ì‘ì„ í–ˆì„ ê²½ìš° ë¶„ê¸°ì ì„ ë§Œë“¤ì–´ ë‹¤ë¥¸ ì¡°ê±´ë¬¸ì´ ì‹¤í–‰ë˜ë„ë¡ í•˜ê¸° ìœ„í•¨ì´ë‹¤.)_

### 3.RNNì˜ LSTMì„ ì‚¬ìš©í•˜ì—¬ ë™ì ì¸ ì†ë™ì‘(next, prev)ì„ í•™ìŠµ

#### 3-1.windowë¥¼ ìƒì„±

RNNì˜ LSTMì„ ì‚¬ìš©í•˜ì—¬ ë™ì ì¸ ë™ì‘ì„ í•™ìŠµì‹œí‚¤ëŠ” ê³¼ì •ë„ ë²¡í„°ì‚¬ì´ì˜ ê°ë„ë¥¼ ì´ìš©í•œë‹¤. í•˜ì§€ë§Œ **window**ë¼ëŠ” ê²ƒì„ ë§Œë“¤ì–´ì•¼ í•˜ëŠ”ë° ì´ê²ƒì€ LSTMì˜ ê¸°ë³¸ ê°œë…ì¸ `ìµœê·¼ ~ê°œì˜ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ë‹¤ìŒ ë°ì´í„°ë¥¼ ì˜ˆì¸¡í•˜ê¸°` ìœ„í•´ì„œì´ë‹¤.

```
seq_length = 30
```

seq\_length=30, ì¦‰ window ì‚¬ì´ì¦ˆë¥¼ 30ìœ¼ë¡œ ì„¤ì •í•˜ì˜€ë‹¤.  
_(ìµœê·¼ 30ê°œì˜ ë°ì´í„°ë¥¼ ë³´ê³  ë‹¤ìŒ ë°ì´í„°ë¥¼ ì˜ˆì¸¡í•˜ê²Œ ëœë‹¤)_

![image](https://github.com/mincheolsong/mincheolsong/assets/80660585/fecd7854-c53d-466c-b9e2-939aa840b12e)  


ì‚¬ì§„ì¶œì²˜ : ë¹µí˜•ì˜ ê°œë°œë„ìƒêµ­ ìœ íŠœë¸Œ

ìœ„ ê·¸ë¦¼ì—ì„œ ë³´ëŠ”ê²ƒ ì²˜ëŸ¼ ë¹¨ê°„ìƒ‰ windowë¥¼ ë§Œë“¤ê³  ê·¸ ë‹¤ìŒ í•œì¹¸ì”© ë‚´ë ¤ê°€ë©´ì„œ windowë¥¼ ê³„ì† ë§Œë“ ë‹¤. (ë…¸ë€ìƒ‰ windowë¥¼ë§Œë“¤ê³ , ì´ˆë¡ìƒ‰ window ...)

```
    full_seq_data = []
    for seq in range(len(data) - seq_length):
        full_seq_data.append(data[seq:seq + seq_length])

    full_seq_data = np.array(full_seq_data)
    np.save(os.path.join('dataset', f'seq_{action}_{created_time}'), full_seq_data)
```

ê·¸ ë‹¤ìŒ forë¬¸ì„ ëŒë©´ì„œ full\_seq\_dataë¼ëŠ” ë¦¬ìŠ¤íŠ¸ì— 30ê°œì˜ í•œ ìŠ¤í…ì”© ë„˜ì–´ê°€ë©´ì„œ ë°ì´í„°ë¥¼ ì €ì¥í•˜ì—¬ sequence dataSetíŒŒì¼ì„ ë§Œë“ ë‹¤.

#### 3-2.dataSetíŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ train

```
actions = [
    'prev',
    'next',
    'stop'
]

data = np.concatenate([
    np.load('dataset/seq_prev_1653293844.npy'),
    np.load('dataset/seq_next_1653293844.npy'),
    np.load('dataset/seq_stop_1653293844.npy'),
], axis=0)
```

ì•¡ì…˜ì„ 3ê°œë¡œ ì •ì˜í•´ì£¼ê³ , ìœ„ì—ì„œ ë§Œë“  dataSetì„ ì „ë¶€ load í›„ í•˜ë‚˜ë¡œ í•©ì³ì¤€ë‹¤.

```
x_data = data[:, :, :-1]
labels = data[:, 0, -1]
```

ë¼ë²¨ê³¼ ë°ì´í„°ë¥¼ ë¶„ë¦¬í•˜ì—¬ ì¤€ë‹¤.

ê·¸ ë‹¤ìŒ ë¼ë²¨ì„ Categorical dataë¡œ ë§Œë“¤ì–´ ì£¼ê¸° ìœ„í•´ One-Hot Encodingì„ í•´ì•¼ í•œë‹¤.

> One-Hot Encodingì´ë€ ì‚¬ëŒì´ ì´í•´í•˜ëŠ” ë°ì´í„°ë¥¼ ì»´í“¨í„°ì—ê²Œ ì£¼ì…ì‹œí‚¤ê¸° ìœ„í•œ ê°€ì¥ ê¸°ë³¸ì ì¸ ë°©ë²•ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.  
>   
> ë°ì´í„°ë¥¼ ìˆ˜ ë§ì€ 0ê³¼ í•œ ê°œì˜ 1 ê°’ìœ¼ë¡œ êµ¬ë¶„í•œë‹¤. ì˜ˆë¥¼ë“¤ì–´ ìˆ«ì 0ë¶€í„° 9ê¹Œì§€ êµ¬ë¶„í•˜ë ¤ í•œë‹¤ë©´ `[1,0,0,0...0]`  
>   
> `[0,1,0,0...0]` `[0,0,1,0...0]` `...` `[0,0,0,0...1]` ì´ë ‡ê²Œ ì¸ì½”ë”©í•˜ëŠ” ê²ƒì´ë‹¤.

```
from tensorflow.keras.utils import to_categorical

y_data = to_categorical(labels, num_classes=len(actions))
print(y_data.shape)
```

tensorflow kerasì˜ to\_categoricalì„ ì‚¬ìš©í•˜ì—¬ One-Hot Encodingì„ ì ìš©í•˜ì˜€ë‹¤.

```
from sklearn.model_selection import train_test_split

x_data = x_data.astype(np.float32)
y_data = y_data.astype(np.float32)

x_train, x_val, y_train, y_val = train_test_split(x_data, y_data, test_size=0.1, random_state=2021)
```

sklearnì˜ train\_test\_splitì„ ì‚¬ìš©í•´ì„œ training setê³¼ test setìœ¼ë¡œ ë‚˜ëˆ ì¤€ë‹¤. training setì€ 90%, test setì€ 10% ë¡œ ë‚˜ëˆ ì¤€ë‹¤.

> **training set(í•™ìŠµ ë°ì´í„°ì…‹)** : ëª¨ë¸ì˜ í•™ìŠµì„ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ì´ë‹¤.  
> **test set(í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹)** : ìƒì„±ëœ ëª¨ë¸ì˜ ì˜ˆì¸¡ì„±ëŠ¥ì„ í‰ê°€í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤.

```
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import LSTM, Dense

model = Sequential([
    LSTM(64, activation='relu', input_shape=x_train.shape[1:3]),
    Dense(32, activation='relu'),
    Dense(len(actions), activation='softmax')
])

model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['acc'])
model.summary()
```

ëª¨ë¸ì„ ì •ì˜í•˜ëŠ” ì½”ë“œì´ë‹¤.

  
Sequential APIë¥¼ ì‚¬ìš©í•˜ì—¬ LSTMê³¼ DENSE ë‘ê°œë¥¼ ì—°ê²°í•˜ì—¬ ì¤€ë‹¤. LSTMì˜ ë…¸ë“œ ê°¯ìˆ˜ëŠ” 64ê°œ activation ì€ reluë¥¼ ì‚¬ìš©, Denseì˜ ë…¸ë“œ ê°¯ìˆ˜ëŠ” 32ê°œ activationì€ reluë¥¼ ì‚¬ìš©í•œë‹¤. ê·¸ë¦¬ê³  activationì€ softmaxë¥¼ ì‚¬ìš©í•œë‹¤.

lossëŠ” categorical\_crossentropyë¥¼ ì‚¬ìš©í•˜ì—¬ 3ê°œì˜ ë™ì‘ ì¤‘ ì–´ë–¤ê²ƒì¸ê°€ë¥¼ modelí•œí…Œ ì¶”ë¡ í•˜ê²Œ í•œë‹¤.

```
history = model.fit(
    x_train,
    y_train,
    validation_data=(x_val, y_val),
    epochs=200,
    callbacks=[
        ModelCheckpoint('models/model.h5', monitor='val_acc', verbose=1, save_best_only=True, mode='auto'),
        ReduceLROnPlateau(monitor='val_acc', factor=0.5, patience=50, verbose=1, mode='auto')
    ]
)
```

ìµœì¢…ì ìœ¼ë¡œ í•™ìŠµì„ ì‹œí‚¤ëŠ” ê³¼ì •ì´ë‹¤.

ìˆœì„œë„

![image](https://github.com/mincheolsong/mincheolsong/assets/80660585/05a19494-d5d5-4b1c-aa63-b5b1c949565d)  


ìˆ˜í–‰ê²°ê³¼

![image](https://github.com/mincheolsong/mincheolsong/assets/80660585/b9c3916b-d32b-4131-9d4c-97cd81b42562)


## ì°¸ì¡°

ìœ íŠœë¸Œ 'ë¹µí˜•ì˜ ê°œë°œë„ìƒêµ­'  
ğŸ‘‡  
[ë¹µí˜•ì˜ ê°œë°œë„ìƒêµ­](https://www.youtube.com/c/%EB%B9%B5%ED%98%95%EC%9D%98%EA%B0%9C%EB%B0%9C%EB%8F%84%EC%83%81%EA%B5%AD)

## í•œê³„

ì–‘ì†ì„ ì‚¬ìš©í•˜ì—¬ ë™ì ì¸ ë™ì‘ì´ ë§ì€ ìˆ˜í™”ë¥¼ í•™ìŠµì‹œí‚¤ëŠ” ê²ƒì— ì–´ë ¤ì›€ì„ ëŠê»´, ìˆ˜í™”ì˜ í•œ ì¢…ë¥˜ì¸ ì§€í™”ë¥¼ êµ¬í˜„í•˜ì˜€ë‹¤. ê·¸ë¦¬ê³  ì§€í™”ë¥¼ í†µí•´ í•œì •ëœ ë‹¨ì–´ë¥¼ ë²ˆì—­í•˜ëŠ”ê²ƒì— ê·¸ì³¤ë‹¤.

## ê°œì„ í•˜ê³  ì‹¶ì€ì 

ëª¨ìŒì˜ ì§€í™”ë¥¼ ì¶”ê°€í•˜ì—¬, ììŒê³¼ ëª¨ìŒì„ ì¡°í•©í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ë§Œë“¤ë©´ ì§€ê¸ˆë³´ë‹¤ëŠ” ë” ì™„ì„±ë„ ìˆëŠ” í”„ë¡œê·¸ë¨ì´ ë  ê²ƒ ê°™ë‹¤.

## ëŠë‚€ì 

íŒŒì´ì¬ì´ ì„œíˆ´ì—ˆê³ , ë”¥ëŸ¬ë‹ë„ ì²˜ìŒì´ì—ˆë‹¤. ê½¤ ì˜¤ëœê¸°ê°„ ë™ì•ˆ êµ¬ê¸€ ìœ íŠœë¸Œ ë“±ì„ ì°¾ì•„ë³´ë©° ì–´ë–»ê²Œë“  í•´ë‚´ê³ ì í•˜ì˜€ë‹¤. í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° ëŒ€ëµì ì¸ ë”¥ëŸ¬ë‹ì˜ ê°œë…ì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤. ì™„ë²½í•˜ì§„ ì•Šì§€ë§Œ ë”¥ëŸ¬ë‹ì„ ì‚¬ìš©í•´ë´¤ë‹¤ëŠ” ì ê³¼ ê²°ê³¼ë¬¼ì„ ë§Œë“¤ì–´ ëƒˆë‹¤ëŠ” ì ì— ì˜ì˜ë¥¼ ë‘ê³  ì‹¶ë‹¤.ğŸ‘

---

\[ì „ì²´ì½”ë“œ : [ìº¡ìŠ¤í†¤ê²½ì§„ëŒ€íšŒ ì‹œì—°ì„ ìœ„í•´ guië¥¼ ì¶”ê°€í•œ ì½”ë“œ](https://github.com/mincheolsong/capston)\]
